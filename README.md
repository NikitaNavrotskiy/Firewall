# **Firewall**

## **Описание проекта**
В данном проекте реализована программа, которая работает с цепочками для принятия решения о допуске или блокировке сетевого пакета.

## **Пакеты**
Пакеты представляют собой строку следующего формата:
`$src_ip $dst_ip $sport $dport $proto`, где $src_ip, $dst_ip - ip адреса источки и получателя,  $sport, $dport - порты источкика и получателся, $proto - протокол (6 - TCP, 17 - UDP). Все параметры должны подаваться в таком порядке, пропуск любого параметра не допускается. В случае попадания строки, не соответствующего формата, строка будет пропущена.

## **Файлы правил**
Файлы для описания цепочек правил представляют собой текстовые файлы, которые позволяют описывать правила для обработки пакетов. Одна строка - одно правило, првила проверяются сверху вних по файлу, если пакет подходит - выносится вердикт. Строка должна быть описана следующим форматом, иначе будет пропущена:
`[src: $IP[/$MASK]] [sport: $PORT] [dst: $IP[/$MASK] dort:] [dport: $PORT] [proto: (tcp|udp)] (ACCEPT|DROP)`,
где $IP, $PORT, $MASK - ip адрес, порт и маска подсети соответственно. Ни один из параметров не является обязательным, но должен быть хотя бы один. Действие для пакета является обязательным, парядок следование параметров важен. В папке `samples` находятся примеры таких файлов с расширением `.fwall`

## **Утилита Fwall**

Fwall - утилита командной строки, для обработки пакетов правилами из файла. Файл правил и пакеты должны соответствовать форматам, описанным выше. 

Использование:
`fwall -f $db_file [OPTIONS]...`
Опции:
 - -f, --file-db: Файл с правилами. Обязательный параметр.
 - -i, --input: Файл, через который подаются пакеты на вход программе. Необязательный параметр. Без данного параметра, пакеты подаются через `stdin`.
 - -o, --output: Файл, в который логируются решения по пакетам. Необязательный параметр. Без данного параметра, вывод происходит в `stdout`.
 
## **Утилита Gen_fwall**

Fwall - утилита командной строки, генерации пакетов правильного формата. 

Использование:
`gen_fwall [OPTIONS]...`
Опции:
 - -c, --count: Указывает количество пакетов для генерации. Необязательный параметр, по умолчанию количество равно `10`.
 - -o, --output: Файл, в который записываются сгенерированные пакеты. Необязательный параметр. Без данного параметра, вывод происходит в `stdout`.
 - -t, --timeout: Пауза в миллисекундах, которую необходимо делать между генерацией пакетов. Необязательный параметр, по умолчанию пазуы не происходит.
 - 
 ## **Makefile**

Сборка программ происходит с помощью Makefile.
Предусмотренны следующие цели:
 * all: Собирает обе утилиты, компилируя их в папку `build`
 * clean: Удаляются все файлы, которые появляются во время и после сборки программы.
 * test: Компиляция файлы с тестами.
 * gcov: Создание html документа покрытия.
 
## **Тесты**

Тесты сделаны при помощи библиотеки `check`. 
Файл с тестами компилируется командой `make test`.

## **Документаци**

Документация сделана при помощи Doxygen. Ее можно открыть командой `make doc`.

